import{p as I,k as M,r as x,o as e}from"./index-d2019b9c.js";import{H as X}from"./Header-373df5dd.js";import{B as W}from"./button.esm-fc5acb7a.js";import{P as Y}from"./panel.esm-82be964f.js";const J=()=>{var b,w,p,j,N,v,y,P,k,S,C;const u=I(),{state:s}=M(),g=x.useRef(null);return x.useEffect(()=>{var i;const t=g.current,l=t==null?void 0:t.getContext("2d");if(l){l.clearRect(0,0,t==null?void 0:t.width,t==null?void 0:t.height);const n=new Image;n.src=(i=s==null?void 0:s.imageSelected)==null?void 0:i.url,n.onload=()=>{var R;const m=n.width,$=n.height,c=t.width,h=$/m*c;t.width=c,t.height=h,l==null||l.clearRect(0,0,c,h),l==null||l.drawImage(n,0,0,c,h),(R=s.polygons)==null||R.forEach(a=>{const d=new Path2D,[T,...B]=a.points;d.moveTo(T.x,T.y),B.forEach(r=>{d.lineTo(r.x,r.y)}),d.closePath(),l.strokeStyle=a.color,l.lineWidth=2,l.fillStyle=`${a.color}60`,l.fill(d);const E=a.points.reduce((r,f)=>r+f.x,0)/a.points.length,H=a.points.reduce((r,f)=>r+f.y,0)/a.points.length;l.fillStyle="white";const o=4,A=l.measureText(a.label).width+5,D=14;l.fillRect(E-A/2-o,H-D/2-o,A+2*o,D+1*o),l.fillStyle="black",l.font="12px Arial",l.textAlign="center",l.textBaseline="middle",l.fillText(a.label,E,H),l.stroke(d)})}}},[s.polygons,(b=s==null?void 0:s.imageSelected)==null?void 0:b.url]),e.jsxs("div",{className:"w-screen h-[100dvh] relative flex flex-col bg-ochre",children:[e.jsx(X,{}),e.jsx("div",{className:"customScrollbar h-full py-3 px-1 sm:px-3 my-3 mx-0 sm:mx-3 flex flex-col justify-around items-center bg-metallic-brown rounded-lg shadow-md overflow-y-auto",children:e.jsxs("div",{className:"w-full h-full flex flex-col gap-y-3 md:gap-y-5 overflow-y-auto",children:[e.jsxs("div",{className:"px-2 md:px-0 flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-lg md:text-xl font-medium text-naples-yellow",children:"Preview Data"}),e.jsx("span",{className:"text-sm md:text-base text-bud-green font-medium",children:"Preview the data before proceeding"})]}),e.jsx("div",{className:"hidden md:flex flex-row gap-x-10",children:e.jsx(W,{disabled:((p=(w=s==null?void 0:s.imageSelected)==null?void 0:w.url)==null?void 0:p.length)<=0||((j=s.polygons)==null?void 0:j.length)<1,icon:"pi pi-check",label:"Continue",className:"h-10 text-metallic-brown bg-naples-yellow border-naples-yellow",onClick:()=>{x.startTransition(()=>{u("/success")})}})})]}),e.jsxs("div",{className:"w-full h-full flex flex-col md:flex-row gap-2",children:[e.jsx("div",{className:"w-full md:w-2/4 lg:w-2/5 h-fit md:mb-0 mx-auto",children:e.jsx("div",{className:"w-fit h-fit m-auto border-2 border-ochre rounded-lg",children:e.jsx("canvas",{className:"mx-auto rounded-lg",ref:g})})}),e.jsx("div",{className:"w-full md:w-2/4 lg:w-3/5",children:e.jsxs("div",{className:"w-full p-3 rounded-xl bg-fern-green",children:[e.jsx("div",{className:"flex justify-between items-center text-base text-blue-900 pb-2",children:e.jsxs("span",{className:"text-base sm:text-lg text-naples-yellow font-semibold",children:["Annotations (",((N=s.polygons)==null?void 0:N.length)<10?`0${(v=s.polygons)==null?void 0:v.length}`:`${(y=s.polygons)==null?void 0:y.length}`,")"]})}),e.jsx("div",{children:(P=s.polygons)==null?void 0:P.map((t,l)=>{var i;return e.jsx("div",{className:"mt-2",children:e.jsx(Y,{className:"annotationPanel w-full mb-1",collapsed:!0,header:e.jsx("div",{className:"w-full h-full flex justify-between items-center",children:e.jsx("span",{className:"text-base sm:text-lg text-metallic-brown",children:t==null?void 0:t.label})}),toggleable:!0,children:e.jsxs("div",{className:"w-full flex flex-col gap-y-1",children:[e.jsxs("p",{className:"w-full p-2 bg-fern-green text-naples-yellow font-medium rounded-lg",children:["Coordinates -"," "]}),(i=t.points)==null?void 0:i.map((n,m)=>e.jsxs("p",{className:"w-full flex flex-row items-center gap-x-1",children:[e.jsx("span",{className:"w-[20%] p-2 border-2 border-bud-green text-metallic-brown rounded-lg",children:"X:"}),e.jsx("span",{className:"w-[30%] p-2 border-2 border-bud-green text-metallic-brown rounded-lg",children:Math.round(n.x)}),e.jsx("span",{className:"w-[20%] p-2 border-2 border-bud-green text-metallic-brown rounded-lg",children:"Y:"}),e.jsx("span",{className:"w-[30%] p-2 border-2 border-bud-green text-metallic-brown rounded-lg",children:Math.round(n.y)})]},m))]})})},l)})})]})})]})]})}),e.jsx("div",{className:"w-full p-2 flex md:hidden flex-col items-center sticky bottom-0 left-0 right-0 bg-metallic-brown rounded-t-3xl text-xs",children:e.jsx("div",{className:"flex flex-row gap-x-10",children:e.jsx(W,{disabled:((S=(k=s==null?void 0:s.imageSelected)==null?void 0:k.url)==null?void 0:S.length)<=0||((C=s.polygons)==null?void 0:C.length)<1,icon:"pi pi-check",label:"Continue",className:"h-10 text-metallic-brown bg-naples-yellow border-naples-yellow",onClick:()=>{x.startTransition(()=>{u("/success")})}})})})]})};export{J as default};
